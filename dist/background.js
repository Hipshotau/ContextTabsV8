(()=>{"use strict";var e={8:(e,t)=>{function o(e){return new Promise(((t,o)=>{chrome.storage.local.get(e,(e=>{if(chrome.runtime.lastError)return o(chrome.runtime.lastError);t(e)}))}))}function r(e){return new Promise(((t,o)=>{chrome.storage.local.set(e,(()=>{if(chrome.runtime.lastError)return o(chrome.runtime.lastError);t()}))}))}async function a(){const{focusState:e}=await o(["focusState"]);return Object.assign(Object.assign({},{active:!1,allowedContexts:[]}),e)}Object.defineProperty(t,"__esModule",{value:!0}),t.setFocusState=t.getFocusState=t.addContextToHistory=t.setStorage=t.getStorage=void 0,t.getStorage=o,t.setStorage=r,t.addContextToHistory=async function(e,t,a){const{contextHistory:n}=await o(["contextHistory"]),s=n||[];s.push({context:e,url:t,timestamp:Date.now(),confidence:a}),s.length>100&&s.shift(),await r({contextHistory:s})},t.getFocusState=a,t.setFocusState=async function(e){const t=await a();await r({focusState:Object.assign(Object.assign({},t),e)})}},18:(e,t)=>{let o;async function r(){try{if(void 0!==o)try{return await chrome.windows.get(o),o}catch(e){o=void 0}const{id:e}=await chrome.windows.create({url:"about:blank",type:"normal",state:"maximized"});if(o=e,e){const t=await chrome.tabs.query({windowId:e});t.length>0&&t[0].id&&await chrome.tabs.update(t[0].id,{url:chrome.runtime.getURL("blocked.html")+"?mode=welcome"})}return o}catch(e){return void console.error("Error launching focus window:",e)}}Object.defineProperty(t,"__esModule",{value:!0}),t.moveTabToFocusWindow=t.getFocusWindowId=t.closeFocusWindow=t.launchFocusWindow=void 0,t.launchFocusWindow=r,t.closeFocusWindow=async function(){if(void 0!==o)try{await chrome.windows.remove(o),o=void 0}catch(e){console.error("Error closing focus window:",e),o=void 0}},t.getFocusWindowId=function(){return o},t.moveTabToFocusWindow=async function(e){if(void 0===o&&void 0===await r())return!1;try{return await chrome.tabs.move(e,{windowId:o,index:-1}),!0}catch(e){return console.error("Error moving tab to focus window:",e),!1}}},56:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.pickColorForContext=void 0,t.pickColorForContext=function(e){switch(e){case"Work":return"yellow";case"Learning":return"blue";case"Entertainment":return"green";case"News":return"red";case"Shopping":return"purple";case"Social":return"cyan";case"Research":return"pink";case"Development":return"orange";default:return"grey"}}},170:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.removeWorkspace=t.saveCurrentWorkspace=t.restoreWorkspace=t.getTimeLeft=t.isActive=t.isBlocked=t.end=t.start=void 0;const r=o(8),a=o(282),n=o(18),s=o(569),c=o(591);let i,u=!1;t.start=async function(e,t){var o;const s=Array.isArray(e)?e:[],c=t?Date.now()+60*t*1e3:void 0;await(0,r.setFocusState)({active:!0,allowedContexts:s,endTime:c});const i=["Work","Development","Research","Learning","Entertainment","Social","Shopping","News"].filter((e=>!s.includes(e)));await(0,r.setStorage)({blockedCategories:i}),await(0,a.openSidePanel)(),!!(null===(o=(await(0,r.getStorage)(["focusSettings"])).focusSettings)||void 0===o?void 0:o.focusWindowEnabled)&&await(0,n.launchFocusWindow)(),chrome.action.setBadgeText({text:"•"}),chrome.action.setBadgeBackgroundColor({color:"#1565c0"}),chrome.notifications.create({type:"basic",iconUrl:chrome.runtime.getURL("icons/icon48.png"),title:"Focus Session Started",message:t?`Focus session started for ${t} minutes. Stay focused!`:"Focus session started. Stay focused!",priority:2})},t.end=async function(e){if(e)try{const t=await chrome.tabGroups.query({}),o=await Promise.all(t.map((async e=>{const t=await chrome.tabs.query({groupId:e.id});return{groupId:e.id,title:e.title||"",color:e.color,tabUrls:t.map((e=>e.url||""))}}))),{savedWorkspaces:a}=await(0,r.getStorage)(["savedWorkspaces"]),n={name:e,tabGroups:o,timestamp:Date.now()},s=Array.isArray(a)?[...a,n]:[n];await(0,r.setStorage)({savedWorkspaces:s})}catch(e){console.error("Error saving workspace:",e)}await(0,r.setFocusState)({active:!1,endTime:void 0}),await(0,a.closeSidePanel)(),await(0,n.closeFocusWindow)(),await(0,c.ungroupAllTabs)(),chrome.action.setBadgeText({text:""}),u=!1,i&&(clearTimeout(i),i=void 0),chrome.notifications.create({type:"basic",iconUrl:chrome.runtime.getURL("icons/icon48.png"),title:"Focus Session Ended",message:"Your focus session has ended. Great job!",priority:2}),await(0,s.releaseParkedLinks)()},t.isBlocked=async function(e){const t=await(0,r.getFocusState)();return!(!t.active||(Array.isArray(t.allowedContexts)?(console.log("[FocusEngine] allowed:",t.allowedContexts,"context:",e),t.allowedContexts.includes(e)||(u=!0,chrome.action.setBadgeText({text:"!"}),chrome.action.setBadgeBackgroundColor({color:"#d32f2f"}),i&&clearTimeout(i),i=setTimeout((()=>{u&&(u=!1,chrome.action.setBadgeText({text:"•"}),chrome.action.setBadgeBackgroundColor({color:"#1565c0"}))}),3e4),0)):(console.error("[FocusEngine] allowedContexts is not an array:",t.allowedContexts),1)))},t.isActive=async function(){return(await(0,r.getFocusState)()).active},t.getTimeLeft=async function(){const{active:e,endTime:t}=await(0,r.getFocusState)();return e?t?Math.max(0,t-Date.now())/1e3:-1:0},t.restoreWorkspace=async function(e){const{savedWorkspaces:t}=await(0,r.getStorage)(["savedWorkspaces"]);if(!t)return;const o=t.find((t=>t.name===e));if(o)for(const e of o.tabGroups){const t=[];for(const o of e.tabUrls){const e=await chrome.tabs.create({url:o,active:!1});t.push(e.id)}if(t.length>0){const o=await chrome.tabs.group({tabIds:t});await chrome.tabGroups.update(o,{title:e.title||"",color:e.color})}}},t.saveCurrentWorkspace=async function(e){const t=await chrome.tabGroups.query({}),o=await Promise.all(t.map((async e=>{const t=await chrome.tabs.query({groupId:e.id});return{groupId:e.id,title:e.title||"",color:e.color,tabUrls:t.map((e=>e.url||""))}}))),{savedWorkspaces:a}=await(0,r.getStorage)(["savedWorkspaces"]),n={name:e,tabGroups:o,timestamp:Date.now()},s=Array.isArray(a)?[...a,n]:[n];await(0,r.setStorage)({savedWorkspaces:s})},t.removeWorkspace=async function(e){const{savedWorkspaces:t}=await(0,r.getStorage)(["savedWorkspaces"]);if(!t)return;const o=t.filter((t=>t.name!==e));await(0,r.setStorage)({savedWorkspaces:o})}},282:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setSidePanelProperties=t.closeSidePanel=t.openSidePanel=void 0,t.openSidePanel=async function(){try{const e=await chrome.windows.getCurrent();await chrome.sidePanel.open({windowId:e.id}),console.log("Side panel opened successfully")}catch(e){console.error("Error opening side panel:",e)}},t.closeSidePanel=async function(){try{const e=await chrome.sidePanel.getAll();await Promise.all(e.map((e=>chrome.sidePanel.close({windowId:e.windowId})))),console.log("Side panels closed successfully")}catch(e){console.error("Error closing side panels:",e)}},t.setSidePanelProperties=async function(e,t){try{await chrome.sidePanel.setOptions({path:e,enabled:!0}),console.log("Side panel properties updated")}catch(e){console.error("Error setting side panel properties:",e)}}},545:function(e,t,o){var r=this&&this.__createBinding||(Object.create?function(e,t,o,r){void 0===r&&(r=o);var a=Object.getOwnPropertyDescriptor(t,o);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,r,a)}:function(e,t,o,r){void 0===r&&(r=o),e[r]=t[o]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&r(t,e,o);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});const s=o(591),c=o(8),i=o(887),u=o(569),l=n(o(170)),d={},g=chrome.runtime.getURL("blocked.html");async function m(){try{if(!(await(0,c.getFocusState)()).active)return void chrome.action.setBadgeText({text:""});const e=await l.getTimeLeft();if(-1===e)chrome.action.setBadgeText({text:"∞"}),chrome.action.setBadgeBackgroundColor({color:"#1565c0"});else if(e>0){const t=Math.ceil(e/60);chrome.action.setBadgeText({text:t.toString()}),(await(0,i.checkFocusStatus)()).isLostFocus?chrome.action.setBadgeBackgroundColor({color:"#d32f2f"}):chrome.action.setBadgeBackgroundColor({color:"#1565c0"})}else{const e=await(0,i.checkFocusStatus)(),t=e.contextSwitches.length;chrome.action.setBadgeText({text:t.toString()}),e.isLostFocus?chrome.action.setBadgeBackgroundColor({color:"#d32f2f"}):chrome.action.setBadgeBackgroundColor({color:"#1565c0"})}}catch(e){console.error("Error updating badge:",e)}}async function h(e){return(await chrome.storage.local.get([e]))[e]||{contexts:[],training:{falsePositives:[],truePositives:[]}}}async function f(e,t){await chrome.storage.local.set({[e]:t})}chrome.runtime.onMessage.addListener(((e,t,o)=>{var r,a;if("CONTEXT_UPDATE"===e.type||"CONTEXT_DETECTED"===e.type){const o=e.context,a=null===(r=t.tab)||void 0===r?void 0:r.id;return null!=a&&(d[a],d[a]=o,e.confidence,e.secondaryContexts,e.url,chrome.storage.local.set({[e.url]:{context:e.context,confidence:e.confidence}}),async function(e,t){const{autoGroupEnabled:o=!0}=await(0,c.getStorage)(["autoGroupEnabled"]);!1!==o&&(await(0,s.groupTabByContext)(e,t),m())}(a,o).catch((e=>console.error(e)))),!1}if("FOCUS_TOGGLE"===e.type)return async function(e){e?m():(await(0,s.ungroupAllTabs)(),chrome.action.setBadgeText({text:""}))}(e.enabled).catch((e=>console.error(e))),!1;if("START_FOCUS_SESSION"===e.type){const{durationMinutes:t,blockedCategories:r}=e.payload||{},a=["Work","Development","Research","Learning","Entertainment","Social","Shopping","News"].filter((e=>!(null==r?void 0:r.includes(e))));return l.start(a,t).then((()=>o({success:!0}))).catch((e=>{console.error(e),o({success:!1,error:e.message})})),!0}if("END_FOCUS_SESSION"===e.type){const{saveWorkspaceName:t}=e.payload||{};return l.end(t).then((()=>o({success:!0}))).catch((e=>{console.error("Error ending focus session:",e),o({success:!1,error:e.message})})),!0}if("GET_FOCUS_TIME_LEFT"===e.type)return l.getTimeLeft().then((e=>{o({seconds:e})})).catch((e=>{console.error("Error getting focus time left:",e),o({seconds:0})})),!0;if("OVERRIDE_BLOCK"===e.type)return o({success:!0}),!0;if("RESTORE_WORKSPACE"===e.type){const{name:t}=e.payload||{};return l.restoreWorkspace(t).then((()=>o({success:!0}))).catch((e=>{console.error(e),o({success:!1,error:e.message})})),!0}if("CHECK_FOCUS_STATUS"===e.type)return(0,i.checkFocusStatus)().then((e=>o(e))).catch((e=>{console.error("Error checking focus status:",e),o(null)})),!0;if("CONTENT_SCRIPT_READY"===e.type)return null===(a=t.tab)||void 0===a||a.id,o({success:!0}),!0;if("TIMER_EXPIRED"===e.type)return chrome.tabs.query({active:!0,currentWindow:!0},(e=>{e[0]&&e[0].id&&chrome.tabs.sendMessage(e[0].id,{type:"DRIFT_WARNING",message:"Time's up! Return to your primary task now."},(t=>{(chrome.runtime.lastError||void 0===t)&&chrome.tabs.update(e[0].id,{url:g})}))})),o({success:!0}),!0;if("PARK_LINK"===e.type){const{url:t,context:o,title:r}=e;return(async()=>{try{await(0,u.saveForLater)(t,o,r),console.log(`[Parked Links] Saved for later: ${r||t} (${o})`)}catch(e){console.error("Error parking link:",e)}})(),!1}return"RELEASE_PARKED_LINKS"===e.type?((async()=>{try{await(0,u.releaseParkedLinks)(),o({success:!0})}catch(e){console.error("Error releasing parked links:",e),o({success:!1,error:String(e)})}})(),!0):"TRAIN_CONTEXT"===e.type?((async()=>{const{url:t,title:r,actualContext:a,predictedContext:n,isFalsePositive:s}=e,c=await h(t);c.training||(c.training={falsePositives:[],truePositives:[]}),s?c.training.falsePositives.push({timestamp:Date.now(),actualContext:a,predictedContext:n}):c.training.truePositives.push({timestamp:Date.now(),actualContext:a,predictedContext:n}),await f(t,c),await async function(e){const t=await h(e),{training:o}=t;if(!o)return;const r={};o.falsePositives.forEach((e=>{r[e.predictedContext]=.9*(r[e.predictedContext]||1)})),o.truePositives.forEach((e=>{r[e.predictedContext]=1.1*(r[e.predictedContext]||1)})),t.weights=r,await f(e,t)}(t),o({success:!0})})(),!0):"STAY_FOCUSED_ACTION"===e.type?((async()=>{const{url:t,context:r,title:a}=e.payload;try{await(0,u.saveForLater)(t,r,a);const[e]=await chrome.tabs.query({active:!0,currentWindow:!0});(null==e?void 0:e.id)&&await(0,u.goBackOrClose)(e.id),o({success:!0})}catch(e){console.error("Stay‑focused flow failed:",e),o({success:!1,error:e instanceof Error?e.message:String(e)})}})(),!0):"FOCUS_STATUS"===e.type&&((0,c.getFocusState)().then((e=>o(e))).catch((e=>{console.error("Error getting focus status:",e),o(null)})),!0)})),(0,s.onTabRemoved)((e=>{delete d[e]})),chrome.tabs.onUpdated.addListener(((e,t,o)=>{"complete"===t.status&&o.url&&!o.url.startsWith("chrome://")&&setTimeout((()=>{}),500)})),chrome.runtime.onInstalled.addListener((e=>{"install"===e.reason?(chrome.storage.local.set({extensionEnabled:!0,autoGroupEnabled:!0,focusState:{active:!1,allowedContexts:[]},firstRunComplete:!1}),chrome.tabs.create({url:chrome.runtime.getURL("onboarding.html")})):"update"===e.reason&&chrome.storage.local.get(["autoGroupEnabled","focusSessionActive","focusSessionEndTime","blockedCategories","focusState"],(e=>{const t={extensionEnabled:!0};if(!e.focusState&&(e.focusSessionActive||e.blockedCategories)){console.log("Migrating from old focus session format to new focusState format");const o=["Work","Development","Research","Learning","Entertainment","Social","Shopping","News"],r=e.blockedCategories||[],a=o.filter((e=>!r.includes(e)));t.focusState={active:!0===e.focusSessionActive,allowedContexts:a,endTime:e.focusSessionEndTime||void 0},chrome.storage.local.remove(["focusSessionActive","focusSessionEndTime","blockedCategories"])}void 0===e.autoGroupEnabled&&(t.autoGroupEnabled=!0),chrome.storage.local.set(t)}))})),async function(){await(0,c.setStorage)({extensionEnabled:!0}),console.log("[Background] Extension enabled.");const e=await(0,c.getFocusState)();e.active&&(console.log("[Background] Focus session was active at shutdown, verifying..."),!e.endTime||e.endTime<=Date.now()?(console.log("[Background] Focus session expired during shutdown, cleaning up"),await(0,c.setFocusState)({active:!1,endTime:void 0})):console.log(`[Background] Focus session continues until ${new Date(e.endTime).toLocaleTimeString()}`)),chrome.tabs.onUpdated.addListener(((e,t,o)=>{if(t.url&&o.url){const t=o.url;(async()=>{try{const o=await async function(e){if(!(await(0,c.getFocusState)()).active)return!1;try{const t=await h(e),o=null==t?void 0:t.context;return!!o&&l.isBlocked(o)}catch(e){return console.error("Error classifying URL:",e),!1}}(t);if(o){console.log(`[Focus] Blocking URL: ${t}`);try{await chrome.tabs.update(e,{url:g})}catch(e){console.log("Tab navigation error (likely already navigating):",e)}}}catch(e){console.error("Error checking URL:",e)}})()}})),chrome.alarms.create("focusTick",{periodInMinutes:1}),chrome.alarms.create("focusDrift",{periodInMinutes:2}),chrome.alarms.onAlarm.addListener((async({name:e})=>{try{if("focusTick"===e)await async function(){const e=(await(0,c.getFocusState)()).endTime;e&&Date.now()>=e&&await l.isActive()&&(await l.end(),console.log("[Focus] Session ended automatically due to timeout"),chrome.notifications.create({type:"basic",iconUrl:chrome.runtime.getURL("icons/icon48.png"),title:"Focus Session Complete",message:"Your timed focus session has ended."}))}();else if("focusDrift"===e&&await l.isActive()){const e=await(0,i.checkFocusStatus)();e.isLostFocus&&await async function(e){var t,o;try{if(!await l.isActive())return;console.log("[Focus] Sending drift warning to active tab",e);const r=await chrome.tabs.query({active:!0,currentWindow:!0});if(!r.length||!r[0].id)return;const a=r[0],n=a.id;if((null===(t=a.url)||void 0===t?void 0:t.startsWith("chrome://"))||(null===(o=a.url)||void 0===o?void 0:o.startsWith("chrome-extension://")))return;let s="YOU'RE DRIFTING FROM YOUR FOCUS TASK!";if(e.contextSwitches.length>0){const t=e.contextSwitches[e.contextSwitches.length-1];s=`FOCUS LOST: Switched from ${t.from} to ${t.to}`}chrome.tabs.sendMessage(n,{type:"DRIFT_WARNING",message:s},(e=>{(chrome.runtime.lastError||void 0===e)&&chrome.tabs.update(n,{url:g})})),chrome.notifications.create({type:"basic",iconUrl:chrome.runtime.getURL("icons/icon48.png"),title:"FOCUS ALERT!",message:s,priority:2,requireInteraction:!0}),console.log("[Focus] Drift warning sent successfully")}catch(e){console.error("Error sending drift warning:",e)}}(e)}await m()}catch(t){console.error(`Error in alarm handler (${e}):`,t)}}))}().catch(console.error)},569:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.clearParkedLinks=t.showToast=t.goBackOrClose=t.releaseParkedLinks=t.getParkedLinks=t.saveForLater=void 0;const r=o(8);async function a(){const{parkedLinks:e=[]}=await(0,r.getStorage)(["parkedLinks"]);return e}async function n(e,t){try{const o=await chrome.tabs.query({windowId:t.windowId});if(o.length>1){const t=o.findIndex((t=>t.id===e)),r=o[t>0?t-1:(t+1)%o.length];r.id&&(await chrome.tabs.update(r.id,{active:!0}),setTimeout((()=>{chrome.tabs.remove(e).catch((e=>{console.error("Tab removal failed:",e)}))}),100))}else await chrome.tabs.update(e,{url:"about:blank"})}catch(t){console.error("Navigation fallback failed:",t);try{await chrome.tabs.update(e,{url:"about:blank"})}catch(e){console.error("Final fallback failed:",e)}}}t.saveForLater=async function(e,t,o){const{parkedLinks:a=[]}=await(0,r.getStorage)(["parkedLinks"]);if(!a.some((t=>t.url===e))){const n={url:e,title:o,context:t,timestamp:Date.now()};await(0,r.setStorage)({parkedLinks:[...a,n]})}},t.getParkedLinks=a,t.releaseParkedLinks=async function(){const e=await a();if(0===e.length)return;let t;await chrome.windows.getCurrent();try{const o=[];for(const t of e){const e=await chrome.tabs.create({url:t.url,active:!1});e.id&&o.push(e.id)}if(o.length>0)try{t=await chrome.tabs.group({tabIds:o}),t&&await chrome.tabGroups.update(t,{title:"Parked Links",color:"blue"})}catch(e){console.error("Error creating tab group:",e)}await(0,r.setStorage)({parkedLinks:[]}),chrome.notifications.create({type:"basic",iconUrl:chrome.runtime.getURL("icons/icon48.png"),title:"Parked Links Opened",message:`Opened ${e.length} links that were saved during your focus session.`})}catch(e){console.error("Error opening parked links:",e)}},t.goBackOrClose=async function(e){try{const t=await chrome.tabs.get(e);try{const o=await chrome.scripting.executeScript({target:{tabId:e},func:()=>({canGoBack:window.history.length>1,url:window.location.href})}),{canGoBack:r}=o[0].result;if(r)return void await chrome.scripting.executeScript({target:{tabId:e},func:()=>window.history.back()});await n(e,t)}catch(o){console.error("Script execution error:",o);try{await chrome.tabs.goBack(e)}catch(o){await n(e,t)}}}catch(e){console.error("Tab lookup error:",e)}},t.showToast=async function(e,t,o=3e3){try{await chrome.scripting.executeScript({target:{tabId:e},func:(e,t)=>{const o=document.createElement("div");o.style.cssText="\n          position: fixed;\n          bottom: 20px;\n          right: 20px;\n          background-color: rgba(0, 102, 204, 0.9);\n          color: white;\n          padding: 12px 20px;\n          border-radius: 4px;\n          box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);\n          font-family: Arial, sans-serif;\n          z-index: 2147483647;\n          max-width: 300px;\n          transition: opacity 0.3s ease-in-out;\n        ",o.textContent=e,document.body.appendChild(o),setTimeout((()=>{o.style.opacity="0",setTimeout((()=>o.remove()),300)}),t-300)},args:[t,o]})}catch(e){console.error("Error showing toast:",e)}},t.clearParkedLinks=async function(){await(0,r.setStorage)({parkedLinks:[]})}},591:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ungroupAllTabs=t.onTabRemoved=t.groupTabByContext=void 0;const r=o(56);t.groupTabByContext=async function(e,t){let o=(await chrome.tabGroups.query({})).find((e=>e.title===t));if(o)await chrome.tabs.group({groupId:o.id,tabIds:[e]});else{const a=await chrome.tabs.group({tabIds:[e]});o=await chrome.tabGroups.update(a,{title:t,color:(0,r.pickColorForContext)(t)})}},t.onTabRemoved=function(e){chrome.tabs.onRemoved.addListener(e)},t.ungroupAllTabs=async function(){const e=await chrome.tabGroups.query({});for(const t of e){const e=await chrome.tabs.query({groupId:t.id});e.length&&await chrome.tabs.ungroup(e.map((e=>e.id)))}}},887:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.showFocusNotification=t.checkFocusStatus=t.getContextSwitches=t.updateFocusSettings=t.getFocusSettings=void 0;const r=o(8),a={enabled:!0,notificationsEnabled:!0,switchThreshold:5,timeWindowMinutes:15};async function n(){const{focusSettings:e}=await(0,r.getStorage)(["focusSettings"]);return Object.assign(Object.assign({},a),e)}async function s(e=15){const{contextHistory:t}=await(0,r.getStorage)(["contextHistory"]);if(!t||t.length<2)return[];const o=[],a=Date.now(),n=60*e*1e3,s=t.filter((e=>a-e.timestamp<n));for(let e=1;e<s.length;e++)s[e].context!==s[e-1].context&&o.push({from:s[e-1].context,to:s[e].context,timestamp:s[e].timestamp,fromUrl:s[e-1].url,toUrl:s[e].url});return o}t.getFocusSettings=n,t.updateFocusSettings=async function(e){const t=await n();await(0,r.setStorage)({focusSettings:Object.assign(Object.assign({},t),e)})},t.getContextSwitches=s,t.checkFocusStatus=async function(){const e=await n(),t=await s(e.timeWindowMinutes);let o="Unknown",a=1;const{contextHistory:c}=await(0,r.getStorage)(["contextHistory"]);if(c&&c.length>0){o=c[c.length-1].context;let e=c.length-1;for(;e>0&&c[e].context===o;)a++,e--}return{isLostFocus:t.length>=e.switchThreshold,contextSwitches:t,currentStreak:a,currentContext:o}},t.showFocusNotification=function(e){chrome.notifications.create({type:"basic",iconUrl:chrome.runtime.getURL("icons/icon48.png"),title:"Focus Alert",message:`You've switched contexts ${e.length} times recently. Try to maintain focus.`,buttons:[{title:"View Details"}]})}}},t={};!function o(r){var a=t[r];if(void 0!==a)return a.exports;var n=t[r]={exports:{}};return e[r].call(n.exports,n,n.exports,o),n.exports}(545)})();
//# sourceMappingURL=background.js.map